<section class="space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-semibold">Dashboard</h1>
    <div class="flex items-center gap-2">
      @if (lastUpdated) {
        <span class="text-xs text-base-content/70">Updated: {{ lastUpdated | date: 'shortTime' }}</span>
      }
      <button class="btn btn-sm" [disabled]="loading" (click)="refresh()">Refresh</button>
    </div>
  </div>

  @if (errorMessage) {
    <div class="alert alert-error text-sm">{{ errorMessage }}</div>
  }

  <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <div class="stat bg-base-100 border border-base-300 rounded-box">
      <div class="stat-title">Active links</div>
      <div class="stat-value text-primary">{{ linksStats?.active ?? '-' }}</div>
    </div>
    <div class="stat bg-base-100 border border-base-300 rounded-box">
      <div class="stat-title">Expired links</div>
      <div class="stat-value">{{ linksStats?.expired ?? '-' }}</div>
    </div>
    <div class="stat bg-base-100 border border-base-300 rounded-box">
      <div class="stat-title">Revoked links</div>
      <div class="stat-value">{{ linksStats?.revoked ?? '-' }}</div>
    </div>
    <div class="stat bg-base-100 border border-base-300 rounded-box">
      <div class="stat-title">Unique origins</div>
      <div class="stat-value">{{ summaryStats?.uniqueOrigins ?? '-' }}</div>
    </div>
  </div>

  <div class="grid sm:grid-cols-3 gap-4">
    <div class="stat bg-base-100 border border-base-300 rounded-box"><div class="stat-title">Total access</div><div class="stat-value">{{ summaryStats?.total ?? '-' }}</div></div>
    <div class="stat bg-base-100 border border-base-300 rounded-box"><div class="stat-title">Success</div><div class="stat-value text-success">{{ summaryStats?.success ?? '-' }}</div></div>
    <div class="stat bg-base-100 border border-base-300 rounded-box"><div class="stat-title">Failed</div><div class="stat-value text-error">{{ summaryStats?.failed ?? '-' }}</div></div>
  </div>

  <div class="grid lg:grid-cols-2 gap-4">
    <div class="overflow-x-auto card bg-base-100 border border-base-300">
      <div class="card-body">
        <h2 class="card-title text-base">Access by hour</h2>
        <table class="table table-zebra table-sm">
          <thead><tr><th>Hour</th><th>Count</th></tr></thead>
          <tbody>
            @for (item of hourly; track item.hour) {
              <tr><td>{{ item.hour }}</td><td>{{ item.count }}</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>

    <div class="overflow-x-auto card bg-base-100 border border-base-300">
      <div class="card-body">
        <h2 class="card-title text-base">Access by day</h2>
        <table class="table table-zebra table-sm">
          <thead><tr><th>Date</th><th>Count</th></tr></thead>
          <tbody>
            @for (item of daily; track item.accessDate) {
              <tr><td>{{ item.accessDate }}</td><td>{{ item.count }}</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>

    <div class="overflow-x-auto card bg-base-100 border border-base-300">
      <div class="card-body">
        <h2 class="card-title text-base">Failure reasons</h2>
        <table class="table table-zebra table-sm">
          <thead><tr><th>Result</th><th>Count</th></tr></thead>
          <tbody>
            @for (item of failures; track item.result) {
              <tr><td>{{ item.result }}</td><td>{{ item.count }}</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>

    <div class="overflow-x-auto card bg-base-100 border border-base-300">
      <div class="card-body">
        <h2 class="card-title text-base">Top links</h2>
        <table class="table table-zebra table-sm">
          <thead><tr><th>shortCode</th><th>Access count</th></tr></thead>
          <tbody>
            @for (item of topLinks; track item.shortCode) {
              <tr><td>{{ item.shortCode }}</td><td>{{ item.accessCount }}</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>

  @if (securityExceptions.length > 0) {
    <div class="overflow-x-auto card bg-base-100 border border-base-300">
      <div class="card-body">
        <h2 class="card-title text-base">Security exceptions</h2>
        <table class="table table-zebra table-sm">
          <thead><tr><th>shortCode</th><th>Count</th></tr></thead>
          <tbody>
            @for (item of securityExceptions; track item.shortCode) {
              <tr><td>{{ item.shortCode }}</td><td>{{ item.count }}</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  }
</section>
